# æ°´æœå•†åŸå°ç¨‹åºæ•°æ®åº“è¡¨ç»“æ„è¯¦è§£

## ğŸ“Š æ•°æ®åº“æ¦‚è§ˆ

æœ¬é¡¹ç›®ä½¿ç”¨å¾®ä¿¡äº‘å¼€å‘æ•°æ®åº“ï¼Œå…±æ¶‰åŠ **6ä¸ªä¸»è¦æ•°æ®é›†åˆï¼ˆè¡¨ï¼‰**ï¼Œç”¨äºç®¡ç†å•†å“ã€è®¢å•ã€ç”¨æˆ·ã€è®¾ç½®ç­‰æ ¸å¿ƒä¸šåŠ¡æ•°æ®ã€‚

---

## ğŸ 1. fruit-boardï¼ˆå•†å“ä¿¡æ¯è¡¨ï¼‰

### è¡¨ç”¨é€”
å­˜å‚¨æ‰€æœ‰æ°´æœå•†å“çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ˜¯å•†åŸçš„æ ¸å¿ƒå•†å“æ•°æ®è¡¨ã€‚

### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | å¿…å¡« | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|------|--------|
| **_id** | String | âœ… | å•†å“å”¯ä¸€æ ‡è¯†ï¼ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼‰ | `60f1b2c3d4e5f6789abc123` |
| **name** | String | âœ… | å•†å“åç§° | `"çº¢å¯Œå£«è‹¹æœ"` |
| **price** | Number/String | âœ… | å•†å“ä»·æ ¼ï¼ˆå…ƒï¼‰ | `8.99` |
| **unit** | String | âœ… | è®¡é‡å•ä½ | `"æ–¤"`, `"ç›’"`, `"ä¸ª"` |
| **imgUrl** | String | âœ… | å•†å“å›¾ç‰‡é“¾æ¥ | `"https://img.alicdn.com/..."` |
| **detail** | String | âŒ | å•†å“è¯¦ç»†æè¿° | `"æ–°é²œç”œè„†çš„çº¢å¯Œå£«è‹¹æœ"` |
| **fruitId** | String | âŒ | è‡ªå®šä¹‰å•†å“ID | `"apple_001"` |
| **iLike** | String/Number | âŒ | ç‚¹èµæ•° | `"128"` |
| **myClass** | String/Number | âŒ | å•†å“åˆ†ç±»æ ‡è¯† | `"1"` (ä»Šæ—¥ç‰¹æƒ ) |
| **onShow** | Boolean | âœ… | æ˜¯å¦åœ¨å‰å°å±•ç¤º | `true` |
| **purchaseFreq** | String/Number | âŒ | è´­ä¹°æ¬¡æ•°/é”€é‡ | `"56"` |
| **service** | String | âŒ | å”®åæœåŠ¡æè¿° | `"7å¤©æ— ç†ç”±é€€æ¢"` |
| **recommend** | String | âŒ | æ˜¯å¦æ¨è | `"1"` (åº—ä¸»æ¨è) |
| **category** | String | âŒ | å•†å“ç±»åˆ« | `"è‹¹æœ"`, `"é¦™è•‰"` |
| **stock** | Number | âŒ | åº“å­˜æ•°é‡ | `100` |
| **time** | String | âŒ | ä¸Šæ¶æ—¶é—´ | `"2024-01-15"` |

### ä¸šåŠ¡é€»è¾‘

#### å•†å“åˆ†ç±»ï¼ˆmyClassï¼‰
```javascript
// åˆ†ç±»æ ‡è¯†å¯¹åº”å…³ç³»
const categories = {
  '0': 'ç¾å‘³é²œæœ',    // å…¨éƒ¨å•†å“
  '1': 'ä»Šæ—¥ç‰¹æƒ ',    // ç‰¹ä»·å•†å“
  '2': 'æ–°é²œä¸Šæ¶',    // æ–°å“
  '3': 'åº—ä¸»æ¨è'     // æ¨èå•†å“ï¼ˆrecommend: '1'ï¼‰
}
```

#### æ•°æ®æ“ä½œç¤ºä¾‹
```javascript
// æŸ¥è¯¢æ‰€æœ‰åœ¨å”®å•†å“
app.getInfoWhere('fruit-board', { onShow: true }, callback)

// æŸ¥è¯¢ç‰¹æƒ å•†å“
app.getInfoWhere('fruit-board', { myClass: '1' }, callback)

// æŸ¥è¯¢æ¨èå•†å“
app.getInfoWhere('fruit-board', { recommend: '1' }, callback)
```

---

## ğŸ“‹ 2. order_masterï¼ˆè®¢å•ä¸»è¡¨ï¼‰

### è¡¨ç”¨é€”
å­˜å‚¨ç”¨æˆ·è®¢å•çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬å•†å“æ¸…å•ã€åœ°å€ã€æ”¯ä»˜çŠ¶æ€ã€é…é€çŠ¶æ€ç­‰ã€‚

### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | å¿…å¡« | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|------|--------|
| **_id** | String | âœ… | è®¢å•å”¯ä¸€æ ‡è¯†ï¼ˆç³»ç»Ÿç”Ÿæˆï¼‰ | `60f1b2c3d4e5f6789def456` |
| **openid** | String | âœ… | ç”¨æˆ·å¾®ä¿¡openId | `"onKwC5ZT_bj3UX10GrLGW3y-o4cY"` |
| **out_trade_no** | String | âœ… | å•†æˆ·è®¢å•å·ï¼ˆæ”¯ä»˜ç”¨ï¼‰ | `"20240115143025123456"` |
| **orderTime** | String | âœ… | è®¢å•åˆ›å»ºæ—¶é—´ | `"2024-01-15 14:30:25"` |
| **total** | String/Number | âœ… | è®¢å•æ€»é‡‘é¢ï¼ˆå…ƒï¼‰ | `"25.99"` |
| **fruitList** | Array | âœ… | å•†å“æ¸…å• | `[["è‹¹æœ", 2, "8.99"], ...]` |

#### ç”¨æˆ·ä¿¡æ¯å­—æ®µ
| å­—æ®µå | æ•°æ®ç±»å‹ | å¿…å¡« | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|------|--------|
| **name** | String | âœ… | æ”¶è´§äººå§“å | `"å¼ ä¸‰"` |
| **phone** | String | âœ… | æ”¶è´§äººæ‰‹æœºå· | `"13800138000"` |
| **schoolName** | String | âœ… | å­¦æ ¡åç§° | `"äº¤å¤§"` |
| **addressItem** | String | âœ… | åœ°å€ç±»å‹ | `"å®¿èˆæ¥¼"`, `"å­¦é™¢"` |
| **detail** | String | âŒ | è¯¦ç»†åœ°å€ | `"1å·æ¥¼101å®¤"` |
| **message** | String | âŒ | é…é€å¤‡æ³¨ | `"è¯·æ”¾åœ¨é—¨å£"` |

#### è®¢å•çŠ¶æ€å­—æ®µ
| å­—æ®µå | æ•°æ®ç±»å‹ | å¿…å¡« | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|------|--------|
| **orderSuccess** | Boolean | âœ… | è®¢å•åˆ›å»ºæˆåŠŸ | `true` |
| **paySuccess** | Boolean | âœ… | æ”¯ä»˜æˆåŠŸçŠ¶æ€ | `true` |
| **payTime** | String | âŒ | æ”¯ä»˜å®Œæˆæ—¶é—´ | `"2024-01-15 14:32:10"` |
| **sending** | Boolean | âŒ | é…é€ä¸­çŠ¶æ€ | `true` |
| **sendingTime** | String | âŒ | å‘è´§æ—¶é—´ | `"2024-01-15 15:00:00"` |
| **finished** | Boolean | âŒ | å·²å®ŒæˆçŠ¶æ€ | `true` |
| **finishedTime** | String | âŒ | å®Œæˆæ—¶é—´ | `"2024-01-15 16:30:00"` |

### è®¢å•çŠ¶æ€æµè½¬

```mermaid
graph LR
    A[è®¢å•åˆ›å»º] --> B[ç­‰å¾…æ”¯ä»˜]
    B --> C[æ”¯ä»˜æˆåŠŸ]
    C --> D[å¾…å‘è´§]
    D --> E[é…é€ä¸­]
    E --> F[å·²å®Œæˆ]
    
    B --> G[æ”¯ä»˜å¤±è´¥]
    G --> H[è®¢å•å–æ¶ˆ]
```

#### çŠ¶æ€åˆ¤æ–­é€»è¾‘
```javascript
// è®¢å•çŠ¶æ€åˆ¤æ–­
function getOrderStatus(order) {
  if (!order.paySuccess) return 'å¾…æ”¯ä»˜'
  if (!order.sending) return 'å¾…å‘è´§'
  if (!order.finished) return 'é…é€ä¸­'
  return 'å·²å®Œæˆ'
}
```

### fruitList æ•°ç»„ç»“æ„
```javascript
// fruitList æ•°ç»„æ ¼å¼
[
  ["å•†å“åç§°", æ•°é‡, "å•ä»·"],
  ["çº¢å¯Œå£«è‹¹æœ", 2, "8.99"],
  ["è„æ©™", 1, "7.80"]
]

// æˆ–è€…å¯¹è±¡æ ¼å¼ï¼ˆæ–°ç‰ˆæœ¬ï¼‰
[
  {
    name: "çº¢å¯Œå£«è‹¹æœ",
    price: 8.99,
    num: 2,
    unit: "æ–¤",
    imgUrl: "https://..."
  }
]
```

---

## âš™ï¸ 3. settingï¼ˆç³»ç»Ÿè®¾ç½®è¡¨ï¼‰

### è¡¨ç”¨é€”
å­˜å‚¨ç³»ç»Ÿå…¨å±€é…ç½®ä¿¡æ¯ï¼Œå¦‚ç»´æŠ¤çŠ¶æ€ã€è¥ä¸šå¼€å…³ç­‰ã€‚

### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | å¿…å¡« | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|------|--------|
| **_id** | String | âœ… | è®¾ç½®é¡¹å”¯ä¸€æ ‡è¯† | `"system_config"` |
| **offLine** | Boolean | âœ… | ç³»ç»Ÿç»´æŠ¤çŠ¶æ€ | `false` |
| **option** | Boolean | âŒ | å½“å‰è¥ä¸šçŠ¶æ€ | `true` |

### ä½¿ç”¨åœºæ™¯
```javascript
// æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦ç»´æŠ¤ä¸­
app.getInfoFromSet('setting', {}, (res) => {
  if (res.data[0].offLine) {
    wx.showModal({
      title: 'ç³»ç»Ÿç»´æŠ¤',
      content: 'ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤ä¸­ï¼Œè¯·ç¨åå†è¯•'
    })
  }
})
```

---

## ğŸ‘¥ 4. customer_infï¼ˆå®¢æˆ·ä¿¡æ¯è¡¨ï¼‰

### è¡¨ç”¨é€”
å­˜å‚¨ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯å’Œåå¥½è®¾ç½®ï¼ˆæ ¹æ®READMEæ˜¾ç¤ºï¼Œä½†ä»£ç ä¸­æœªè§å…·ä½“ä½¿ç”¨ï¼‰ã€‚

### æ¨æµ‹å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|--------|
| **_id** | String | ç”¨æˆ·è®°å½•ID | `"user_001"` |
| **openid** | String | ç”¨æˆ·å¾®ä¿¡openId | `"onKwC5ZT_bj3UX..."` |
| **nickname** | String | ç”¨æˆ·æ˜µç§° | `"å¼ ä¸‰"` |
| **avatar** | String | ç”¨æˆ·å¤´åƒ | `"https://..."` |
| **createTime** | String | æ³¨å†Œæ—¶é—´ | `"2024-01-15"` |

---

## ğŸª 5. fruitStoreï¼ˆå•†åº—ä¿¡æ¯è¡¨ï¼‰

### è¡¨ç”¨é€”
å­˜å‚¨å•†åº—çš„åŸºæœ¬ä¿¡æ¯ï¼ˆæ ¹æ®READMEæ˜¾ç¤ºï¼‰ã€‚

### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | æè¿° | ç¤ºä¾‹å€¼ |
|--------|----------|------|--------|
| **name** | String | å•†åº—åç§° | `"æ–°é²œæ°´æœåº—"` |

---

## ğŸ“ 6. send_formï¼ˆé…é€è¡¨å•è¡¨ï¼‰

### è¡¨ç”¨é€”
å¯èƒ½ç”¨äºå­˜å‚¨é…é€ç›¸å…³çš„è¡¨å•ä¿¡æ¯ï¼ˆæ ¹æ®READMEæ˜¾ç¤ºï¼Œä½†ä»£ç ä¸­æœªè§å…·ä½“ä½¿ç”¨ï¼‰ã€‚

---

## ğŸ”„ æ•°æ®åº“æ“ä½œæ¨¡å¼

### 1. ç›´æ¥æ•°æ®åº“æ“ä½œï¼ˆå°ç¨‹åºç«¯ï¼‰

#### å¸¸ç”¨æ“ä½œæ–¹æ³•ï¼ˆapp.jsä¸­å®šä¹‰ï¼‰
```javascript
// æ·»åŠ æ•°æ®
app.addRowToSet(setName, infoObject, callback)

// æŸ¥è¯¢æ•°æ®
app.getInfoFromSet(setName, selectConditionSet, callback)

// æ¡ä»¶æŸ¥è¯¢
app.getInfoWhere(setName, ruleObj, callback)

// æ’åºæŸ¥è¯¢
app.getInfoByOrder(setName, orderField, orderType, callback)

// åˆ é™¤æ•°æ®
app.deleteRowFromSet(setName, fruitId, callback)

// æ›´æ–°æ•°æ®
app.updateInfo(setName, _id, updateObj, callback)
```

#### å®é™…ä½¿ç”¨ç¤ºä¾‹
```javascript
// æŸ¥è¯¢å•†å“
app.getInfoWhere('fruit-board', { onShow: true }, (res) => {
  console.log('å•†å“åˆ—è¡¨:', res.data)
})

// æŸ¥è¯¢ç”¨æˆ·è®¢å•
app.getInfoWhere('order_master', { openid: userOpenId }, (res) => {
  console.log('ç”¨æˆ·è®¢å•:', res.data)
})

// æ›´æ–°è®¢å•çŠ¶æ€
app.updateInfo('order_master', orderId, {
  sending: true,
  sendingTime: new Date().toLocaleString()
}, (res) => {
  console.log('å‘è´§æˆåŠŸ')
})
```

### 2. äº‘å‡½æ•°æ“ä½œ

ä¸»è¦ç”¨äºéœ€è¦æœåŠ¡ç«¯æƒé™çš„æ“ä½œï¼š
- è·å–ç”¨æˆ·openIdï¼ˆ`add`äº‘å‡½æ•°ï¼‰
- å¾®ä¿¡æ”¯ä»˜ï¼ˆ`pay`äº‘å‡½æ•°ï¼‰
- è·å–IPåœ°å€ï¼ˆ`getIP`äº‘å‡½æ•°ï¼‰

---

## ğŸ“Š æ•°æ®å…³ç³»å›¾

```mermaid
erDiagram
    fruit-board ||--o{ order_master : "åŒ…å«å•†å“"
    order_master }o--|| customer_inf : "å±äºç”¨æˆ·"
    setting ||--o{ order_master : "å½±å“è®¢å•å¤„ç†"
    
    fruit-board {
        string _id PK
        string name
        number price
        string unit
        string imgUrl
        boolean onShow
        string myClass
        string recommend
    }
    
    order_master {
        string _id PK
        string openid FK
        string out_trade_no
        string orderTime
        string total
        array fruitList
        string name
        string phone
        boolean paySuccess
        boolean sending
        boolean finished
    }
    
    customer_inf {
        string _id PK
        string openid UK
        string nickname
        string avatar
    }
    
    setting {
        string _id PK
        boolean offLine
        boolean option
    }
```

---

## ğŸ¯ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### 1. å•†å“å±•ç¤ºæµç¨‹
```
fruit-board(onShow: true) â†’ é¦–é¡µå•†å“åˆ—è¡¨ â†’ å•†å“è¯¦æƒ… â†’ åŠ å…¥è´­ç‰©è½¦
```

### 2. è®¢å•å¤„ç†æµç¨‹
```
è´­ç‰©è½¦ â†’ åˆ›å»ºè®¢å•(order_master) â†’ å¾®ä¿¡æ”¯ä»˜ â†’ æ›´æ–°æ”¯ä»˜çŠ¶æ€ â†’ å•†å®¶å‘è´§ â†’ æ›´æ–°é…é€çŠ¶æ€ â†’ è®¢å•å®Œæˆ
```

### 3. åå°ç®¡ç†æµç¨‹
```
ç®¡ç†å‘˜ç™»å½• â†’ æŸ¥è¯¢è®¢å•åˆ—è¡¨ â†’ è®¢å•å‘è´§ â†’ çŠ¶æ€æ›´æ–° â†’ è“ç‰™æ‰“å°å°ç¥¨
```

---

## ğŸ’¡ æ•°æ®åº“è®¾è®¡ç‰¹ç‚¹

### ä¼˜ç‚¹
1. **ç»“æ„ç®€å•**ï¼šè¡¨ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤
2. **çŠ¶æ€å®Œæ•´**ï¼šè®¢å•çŠ¶æ€æµè½¬å®Œæ•´ï¼Œæ”¯æŒå…¨æµç¨‹è·Ÿè¸ª
3. **æ‰©å±•æ€§å¥½**ï¼šå­—æ®µè®¾è®¡è€ƒè™‘äº†æœªæ¥æ‰©å±•éœ€æ±‚
4. **å¾®ä¿¡ç”Ÿæ€**ï¼šå®Œç¾é€‚é…å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘

### å¯ä¼˜åŒ–ç‚¹
1. **æ•°æ®è§„èŒƒåŒ–**ï¼šéƒ¨åˆ†å­—æ®µç±»å‹ä¸ç»Ÿä¸€ï¼ˆString/Numberæ··ç”¨ï¼‰
2. **ç´¢å¼•ä¼˜åŒ–**ï¼šå¯ä»¥ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
3. **æ•°æ®éªŒè¯**ï¼šç¼ºå°‘å­—æ®µé•¿åº¦å’Œæ ¼å¼éªŒè¯
4. **å…³è”æŸ¥è¯¢**ï¼šå¯ä»¥è€ƒè™‘ä½¿ç”¨èšåˆæŸ¥è¯¢ä¼˜åŒ–æ€§èƒ½

---

## ğŸ“ æ€»ç»“

æœ¬é¡¹ç›®æ•°æ®åº“è®¾è®¡ç®€æ´å®ç”¨ï¼Œæ ¸å¿ƒè¡¨åŒ…æ‹¬ï¼š

1. **fruit-board** - å•†å“ä¿¡æ¯çš„æ ¸å¿ƒå­˜å‚¨
2. **order_master** - è®¢å•å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†  
3. **setting** - ç³»ç»Ÿé…ç½®ç®¡ç†
4. **customer_inf** - ç”¨æˆ·ä¿¡æ¯å­˜å‚¨
5. **fruitStore** - å•†åº—ä¿¡æ¯
6. **send_form** - é…é€è¡¨å•

æ•´ä½“æ¶æ„æ”¯æŒå®Œæ•´çš„ç”µå•†ä¸šåŠ¡æµç¨‹ï¼Œä»å•†å“å±•ç¤ºåˆ°è®¢å•å®Œæˆï¼Œæ•°æ®æµè½¬æ¸…æ™°ï¼ŒçŠ¶æ€ç®¡ç†å®Œå–„ã€‚é…åˆå¾®ä¿¡äº‘å¼€å‘çš„ä¾¿åˆ©æ€§ï¼Œä¸ºå°ç¨‹åºæä¾›äº†ç¨³å®šå¯é çš„æ•°æ®æ”¯æ’‘ã€‚